{% extends 'base.html' %}

{% block content %}


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Marketplace</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
        }

        .filter-form {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 30px;
        }

        .filter-form input[type="text"],
        .filter-form select {
            padding: 8px;
            width: 200px;
        }

        .filter-form button {
            padding: 8px 12px;
            background-color: #3498db;
            color: white;
            border: none;
            cursor: pointer;
        }

        .filter-form button:hover {
            background-color: #2980b9;
        }

        .items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .item-card {
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            background-color: #f9f9f9;
        }

        .item-card h4 {
            margin: 0 0 10px 0;
        }

        .pagination {
            margin-top: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
        }

        .pagination a {
            padding: 8px 12px;
            background-color: #eee;
            text-decoration: none;
            color: #333;
            border-radius: 4px;
        }

        .pagination a:hover {
            background-color: #ddd;
        }

        .pagination span {
            font-weight: bold;
        }
    </style>
</head>
<body>

    <h1>Marketplace</h1>

    <form method="get" action="{{ url_for('marketplace') }}" class="filter-form">
        <input type="text" name="search" placeholder="Search items or users" value="{{ request.args.get('search', '') }}">

        <select name="condition">
            <option value="">All Conditions</option>
            <option value="New" {% if request.args.get('condition') == 'New' %}selected{% endif %}>New</option>
            <option value="Fairly Used" {% if request.args.get('condition') == 'Fairly Used' %}selected{% endif %}>Fairly Used</option>
        </select>

        <button type="submit">Apply Filters</button>
    </form>

    {% if items.items %}
    <div class="items-grid">
        {% for item in items.items %}
            <div class="item-card">
                <h4>{{ item.name }}</h4>
                <p>Condition: {{ item.condition }}</p>
                <p>Uploaded by: {{ item.user.username }}</p>
            </div>
        {% endfor %}
    </div>

    <!-- Pagination -->
    <div class="pagination">
        {% if items.has_prev %}
            <a href="{{ url_for('marketplace', page=items.prev_num, condition=request.args.get('condition'), search=request.args.get('search')) }}">Previous</a>
        {% endif %}

        <span>Page {{ items.page }} of {{ items.pages }}</span>

        {% if items.has_next %}
            <a href="{{ url_for('marketplace', page=items.next_num, condition=request.args.get('condition'), search=request.args.get('search')) }}">Next</a>
        {% endif %}
    </div>
    {% else %}
        <p>No items found matching your criteria.</p>
    {% endif %}

</body>
</html>

{% endblock %}

